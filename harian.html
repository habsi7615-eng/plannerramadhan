<!doctype html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Planner Ramadan Pro Ultimate</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- jsPDF Export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body {
      font-family: "Poppins", sans-serif;
      transition: 0.3s;
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #16a34a;
      color: white;
      padding: 14px 20px;
      border-radius: 12px;
      z-index: 9999;
    }

    .dark-mode {
      background: #0f172a !important;
      color: white !important;
    }

    .dark-card {
      background: #1e293b !important;
      color: white !important;
    }
  </style>
</head>

<body class="bg-gradient-to-br from-green-900 to-emerald-700 min-h-screen">

<!-- ================= LOGIN ================= -->
<div id="loginScreen" class="flex items-center justify-center min-h-screen">
  <div class="bg-white p-8 rounded-2xl shadow-xl max-w-sm w-full text-center">

    <h1 class="text-2xl font-extrabold text-green-800 mb-2">
      ğŸŒ™ Planner Ramadan Pro
    </h1>

    <p class="text-sm text-gray-500 mb-4">
      Login pakai nomor WhatsApp (offline)
    </p>

    <input id="waNumber"
      class="w-full p-3 rounded-xl border mb-4"
      placeholder="Contoh: 08xxxxxxx">

    <button onclick="loginUser()"
      class="w-full py-3 rounded-xl bg-green-700 text-white font-bold hover:opacity-90">
      ğŸ”‘ Masuk Sekarang
    </button>

    <p class="text-xs text-gray-400 mt-4">
      Data aman tersimpan di perangkat Anda.
    </p>
  </div>
</div>


<!-- ================= DASHBOARD ================= -->
<div id="dashboard" class="hidden max-w-5xl mx-auto p-6">

  <!-- Header -->
  <div class="text-center text-white mb-6">
    <h1 class="text-4xl font-bold text-yellow-300">ğŸŒ™ Planner Ramadan Pro Ultimate</h1>
    <p class="text-lg">Checklist Amal + Statistik + Export PDF</p>
    <p id="userLabel" class="text-sm mt-2"></p>

    <!-- Dark Mode Toggle -->
    <button onclick="toggleDarkMode()"
      class="mt-4 px-4 py-2 bg-black/30 rounded-xl">
      ğŸŒ™ Dark Mode Islami
    </button>
  </div>


  <!-- FORM -->
  <div id="cardForm" class="bg-white rounded-2xl shadow-xl p-6 mb-6">

    <h2 class="text-xl font-bold text-green-800 mb-3">
      ğŸ“ Planner Hari Ini
    </h2>

    <input id="dayTitle"
      class="w-full p-3 border rounded-xl mb-3"
      placeholder="Hari ke berapa? (contoh: Hari 10)">

    <!-- Checklist Sholat -->
    <h3 class="font-bold mb-2">ğŸ•Œ Checklist Sholat Wajib</h3>
    <div class="grid grid-cols-2 gap-2 mb-4">
      <label><input type="checkbox" id="subuh"> Subuh</label>
      <label><input type="checkbox" id="dzuhur"> Dzuhur</label>
      <label><input type="checkbox" id="ashar"> Ashar</label>
      <label><input type="checkbox" id="maghrib"> Maghrib</label>
      <label><input type="checkbox" id="isya"> Isya</label>
    </div>

    <!-- Sunnah -->
    <h3 class="font-bold mb-2">ğŸŒ™ Amal Sunnah</h3>
    <div class="grid grid-cols-2 gap-2 mb-4">
      <label><input type="checkbox" id="tarawih"> Tarawih</label>
      <label><input type="checkbox" id="tahajud"> Tahajud</label>
      <label><input type="checkbox" id="sedekah"> Sedekah</label>
      <label><input type="checkbox" id="tilawah"> Tilawah</label>
    </div>

    <textarea id="notes"
      class="w-full p-3 border rounded-xl mb-3"
      rows="3"
      placeholder="Catatan & Muhasabah hari ini..."></textarea>

    <button onclick="saveEntry()"
      class="w-full py-3 rounded-xl bg-green-700 text-white font-bold">
      ğŸ’¾ Simpan Planner Hari Ini
    </button>
  </div>


  <!-- STATISTIK -->
  <div id="cardStats" class="bg-white rounded-2xl shadow-xl p-6 mb-6">
    <h2 class="text-lg font-bold text-green-800 mb-2">
      ğŸ“Š Statistik Amal Ramadan
    </h2>
    <p id="statsText">Belum ada data...</p>
  </div>


  <!-- BUTTONS -->
  <div class="flex gap-3 mb-6">
    <button onclick="exportPDF()"
      class="flex-1 py-3 rounded-xl bg-emerald-600 text-white font-bold">
      ğŸ“„ Export PDF
    </button>

    <button onclick="shareApp()"
      class="flex-1 py-3 rounded-xl bg-yellow-500 text-black font-bold">
      ğŸ”— Share App
    </button>
  </div>


  <!-- LIST -->
  <div id="cardList" class="bg-white rounded-2xl shadow-xl p-6 mb-6">
    <h2 class="text-lg font-bold text-green-800 mb-3">
      ğŸ“Œ Catatan Saya
    </h2>
    <div id="entriesList" class="space-y-3"></div>
  </div>


  <!-- DONATION BOX -->
  <div id="cardDonate" class="bg-white rounded-2xl shadow-xl p-6 text-center">

    <h2 class="text-xl font-bold text-green-800 mb-2">
      ğŸŒŸ Dukung Pengembangan Aplikasi
    </h2>

    <p class="text-gray-600 text-sm mb-4">
      Jika aplikasi ini bermanfaat, Anda bisa berdonasi:
    </p>

    <p class="font-bold">ğŸ“± DANA: 085216175600</p>
    <button onclick="copyText('085216175600')"
      class="mt-2 px-4 py-2 bg-green-700 text-white rounded-xl">
      Copy
    </button>

    <p class="font-bold mt-4">ğŸ¦ Bank Jago: 509102449428</p>
    <button onclick="copyText('509102449428')"
      class="mt-2 px-4 py-2 bg-green-700 text-white rounded-xl">
      Copy
    </button>

    <button onclick="openQRIS()"
      class="mt-4 w-full py-3 bg-yellow-500 rounded-xl font-bold">
      ğŸ“Œ Tampilkan QRIS
    </button>

    <p class="text-xs text-gray-400 mt-4">
      Terima kasih, semoga berkah ğŸŒ™
    </p>
  </div>

</div>


<!-- QRIS POPUP -->
<div id="qrisPopup"
  class="hidden fixed inset-0 bg-black/70 flex items-center justify-center">

  <div class="bg-white p-6 rounded-2xl text-center max-w-lg w-full">
    <h2 class="text-xl font-bold mb-3">Scan QRIS Donasi</h2>

    <img src="https://dummyimage.com/450x450/000/fff.png&text=QRIS+ANDA"
      class="mx-auto rounded-xl shadow-lg">

    <button onclick="closeQRIS()"
      class="mt-4 px-6 py-3 bg-red-500 text-white rounded-xl font-bold">
      Tutup
    </button>
  </div>
</div>


<!-- SCRIPT -->
<script>
  let currentUser = "";
  let entries = [];
  let dark = false;

  function toast(msg) {
    const t = document.createElement("div");
    t.className = "toast";
    t.innerText = msg;
    document.body.appendChild(t);
    setTimeout(() => t.remove(), 2500);
  }

  function loginUser() {
    const wa = document.getElementById("waNumber").value.trim();
    if (wa.length < 8) return toast("âš ï¸ Nomor WA tidak valid");

    currentUser = wa;
    localStorage.setItem("ramadan_user", wa);

    document.getElementById("loginScreen").classList.add("hidden");
    document.getElementById("dashboard").classList.remove("hidden");
    document.getElementById("userLabel").innerText = "Login: " + wa;

    loadEntries();
    toast("âœ… Login berhasil!");
  }

  function loadEntries() {
    const data = localStorage.getItem("entries_" + currentUser);
    entries = data ? JSON.parse(data) : [];
    renderEntries();
    updateStats();
  }

  function saveEntry() {
    const title = document.getElementById("dayTitle").value;
    const notes = document.getElementById("notes").value;

    if (!title) return toast("âš ï¸ Isi judul hari");

    const entry = {
      title,
      notes,
      subuh: subuh.checked,
      dzuhur: dzuhur.checked,
      ashar: ashar.checked,
      maghrib: maghrib.checked,
      isya: isya.checked,
      tarawih: tarawih.checked,
      tahajud: tahajud.checked,
      sedekah: sedekah.checked,
      tilawah: tilawah.checked,
    };

    entries.unshift(entry);
    localStorage.setItem("entries_" + currentUser, JSON.stringify(entries));

    renderEntries();
    updateStats();
    toast("ğŸ’¾ Planner tersimpan!");
  }

  function renderEntries() {
    const list = document.getElementById("entriesList");
    list.innerHTML = "";

    entries.forEach(e => {
      list.innerHTML += `
        <div class="p-3 bg-gray-100 rounded-xl">
          <h3 class="font-bold">${e.title}</h3>
          <p class="text-sm">${e.notes}</p>
        </div>
      `;
    });
  }

  function updateStats() {
    if (entries.length === 0) {
      statsText.innerText = "Belum ada data...";
      return;
    }

    let totalSholat = 0;
    entries.forEach(e => {
      totalSholat += [e.subuh,e.dzuhur,e.ashar,e.maghrib,e.isya].filter(x=>x).length;
    });

    statsText.innerText =
      `Total Catatan: ${entries.length} hari | Total Sholat Tercentang: ${totalSholat}`;
  }

  function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    entries.forEach((e, i) => {
      if (i > 0) doc.addPage();

      doc.text("Planner Ramadan Pro", 10, 10);
      doc.text(e.title, 10, 20);

      doc.text("Catatan:", 10, 35);
      doc.text(e.notes || "-", 10, 45);
    });

    doc.save("planner-ramadan-pro.pdf");
    toast("ğŸ“„ PDF berhasil dibuat!");
  }

  function shareApp() {
    navigator.share({
      title: "Planner Ramadan Pro",
      text: "Aplikasi Planner Ramadan Premium ğŸŒ™",
      url: location.href
    });
  }

  function copyText(txt) {
    navigator.clipboard.writeText(txt);
    toast("âœ… Dicopy: " + txt);
  }

  function openQRIS() {
    qrisPopup.classList.remove("hidden");
  }

  function closeQRIS() {
    qrisPopup.classList.add("hidden");
  }

  function toggleDarkMode() {
    dark = !dark;
    document.body.classList.toggle("dark-mode");

    ["cardForm","cardStats","cardList","cardDonate"].forEach(id=>{
      document.getElementById(id).classList.toggle("dark-card");
    });

    toast("ğŸŒ™ Dark Mode: " + (dark ? "ON" : "OFF"));
  }

  // Auto login
  window.onload = () => {
    const saved = localStorage.getItem("ramadan_user");
    if (saved) {
      currentUser = saved;
      loginScreen.classList.add("hidden");
      dashboard.classList.remove("hidden");
      userLabel.innerText = "Login: " + saved;
      loadEntries();
    }
  };
</script>

</body>
</html>
